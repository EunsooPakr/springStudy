<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="ksmart.mybatis.common.member.mapper.MemberMapper">
	<resultMap id="memberResultMap" type="Member">
		<!-- pk, colum -->
		<id column="m_id" property="memberId"/>
		<result column="m_pw" property="memberPw"/>
		<result column="m_name" property="memberName"/>
		<result column="m_level" property="memberLevel"/>
		<result column="level_name" property="memberLevelName"/>
		<result column="m_email" property="memberEmail"/>
		<result column="m_addr" property="memberAddr"/>
		<result column="m_reg_date" property="memberRegDate"/>
	</resultMap>

	<resultMap id="memberLevelResultMap" type="MemberLevel">
		<id column="level_num" property="levelNum" />
		<result column="level_num" property="levelNum" />
		<result column="level_name" property="levelName" />
		<result column="level_reg_date" property="levelRegDate" />
	</resultMap>

	<!-- $대신 #을 써야한다. preparedStatement 는 #{}, statement 는 ${}로 인식한다. ${}는 ?(값이 들어가야할 컬럼) 칸에 "" 가 안 붙는다. } -->
	<!-- 컬럼을 넣을땐 ${}, 값을 넣어야할땐 #{} 을 사용한다.} -->
	<select id="idCheck" parameterType="String">
		/* 아이디 중복체크 */
		SELECT
			COUNT(m_id)
		FROM
			tb_member
		WHERE
			m_id = #{memberId};
	</select>

	<select id="getMemberLevelList" resultMap="memberLevelResultMap">
		/* 회원 등급 조회 */
		SELECT
			level_num,
			level_name,
			level_reg_date
		FROM
			tb_member_level
	</select>

	<!--application.properties에서 패키지 미리 지정  mybatis.type-aliases-package=ksmart.mybatis.common.*.dto -->
	<!-- ksmart.mybatis.common.*.dto.Member -> member -->
	<!-- ksmart.mybatis.common.*.dto.User -> user -->
	<!-- resultType="ksmart.mybatis.common.member.dto.Member"  -->
	<select id="getMemberList" resultMap="memberResultMap">
		<!-- 회원조회 -->
			SELECT
				m.m_id,
				m.m_pw,
				m.m_name,
				m.m_level,
				l.level_name,
				m.m_email,
				m.m_addr,
				m.m_reg_date
			FROM
				tb_member as m
			inner join
			tb_member_level as l
			on
			m.m_level = l.level_num

	</select>

</mapper>

